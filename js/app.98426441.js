(function(){"use strict";var e={3641:function(e,t,i){var o=i(9507),n=i.n(o),a=i(6848),r=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},s=[],l=i(1656),c={},A=(0,l.A)(c,r,s,!1,null,null,null),d=A.exports,h=i(6178),u=function(){var e=this,t=e._self._c;return t("div",{staticClass:"home"},[t("div",{staticStyle:{width:"620px",height:"350px"}},[t("ImgEdit",{ref:"imgEditComponents"})],1),t("div",{staticStyle:{color:"red"}},[e._v("点选按钮后，在画布长按拖动添加元素。")]),e._m(0),e._m(1)])},f=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"content"},[t("h3",[e._v("说明：")]),t("p",[e._v("其他功能已完成，主要参照示例视频，实现"),t("label",[e._v("添加批注")]),e._v("功能")]),t("p",[e._v("当前技术栈:"),t("label",[e._v("vue2.6")]),e._v(",图片编辑插件:"),t("label",[t("a",{attrs:{target:"_blank",href:"https://www.leaferjs.com/ui/guide/"}},[e._v("leafer.js")])])]),t("p",[e._v("开发环境node版本号:"),t("label",[e._v("18.17.0")])]),t("p",[e._v("git地址："),t("label",[t("a",{attrs:{target:"_blank",href:"https://gitee.com/ilizan/imgedit.git"}},[e._v("gitee")])])]),t("h3",[e._v("示例视频")])])},function(){var e=this,t=e._self._c;return t("div",[t("iframe",{attrs:{width:"700",height:"400",src:"//player.bilibili.com/player.html?isOutside=true&aid=113736673206041&bvid=BV1N96hYzE21&cid=27597737757&p=1",scrolling:"no",border:"0",frameborder:"no",framespacing:"0",allowfullscreen:"true"}})])}],m=function(){var e=this,t=e._self._c;return t("div",{staticClass:"img-edit-box"},[t("div",{staticClass:"img-edit"},[t("div",{staticClass:"canvas",attrs:{id:e.canvasId}}),t("div",{staticClass:"btn-group"},[e._l(e.toolbarMents,(function(i,o){return t("div",{key:o},[t("el-button",{attrs:{type:e.toolbarActiveIndex==o?"primary":"",size:"small",icon:i.icon,title:i.label},on:{click:function(t){return e.clickHandler(o,i.name)}}},[e._v(e._s("添加批注"!=i.label?i.label:i.label+"(缺)"))])],1)})),t("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"image-upload",name:"image",accept:"image/png, image/jpeg, image/gif,image/webp",multiple:""}})],2)])])},p=[],g=(i(4114),i(8992),i(4520),i(3949),i(1333)),v=(i(7377),i(5731),i(8863)),b="data:image/png;base64,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",E="data:image/png;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wAARCAArAFADASIAAhEBAxEB/8QAHAAAAwEAAgMAAAAAAAAAAAAAAAUGBAEDAgcK/8QARRAAAQMCAQUHEQUJAAAAAAAAAQIDBAARBRIUIVLSEzFTVJTR0wYVFiIyNEFRVXGSk5WhoqPUI3OBs7QkQkNEcnSRssL/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/8QAFBEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEQMRAD8A+3Xr3i/lTE/aEvpaOveL+VMT9oS+lpVRQbJfVZjUMMIbnSnMsOqUp6ZNUq4UkWykyUEgX0Aiw01j7OMe4y5yrEPrKTYv/KeZ7/c0ooLDs4x7jLnKsQ+spm31SYxKjsPKxCc0tW6JKWJsxCCErWASFSFkqsN+/iFrJ0+vKpYPeUbzu/mOUFB17xfypiftCX0tHXvF/KmJ+0JfS0qooNczquxuGqO03NlOBbBWS9LmqWVGTKQbqTKTcZLacnQLDtd4CsnZxj3GXOVYh9ZSTGe+I39sf1c6lVBWbq3re5XNRuret7jzVO59O47M5U/0lGfTuOzOVP8ASUGvFlpUYgBBNn7AaSe3O8N8/hSrTqq9FXNVRDffegtF199wl59JUp50qKUlJSnKK75IOkC9gdNq77HXd9c7t0Ehp1VeirmqihrSmHGCjkm7pAIIJ+0c3ha5t4bb3hrbY67vrnduluJyZLBipZkyW0qbWSESHkgndHNJsvf0DT4bAeAUG/dW9b3K5qN1b1vceap3Pp3HZnKn+koz6dx2Zyp/pKDTiywt+KRp/Zb9rc6DLnAHR5vw8NLNOqr0Vc1Vcd992JGLr77hKXbqW86pRyZUsJuoryjYAAad4V2WOu7653boJCiqTMInBfMd26MwicF8x3boOMO7xZ+/kf8ANbaYQocZMNoBuwDz57tzfunxqrRmrHB/EvaoE9JsY7uJ90v8x2rHNWOD+Je1S3E4UVSo2U1ezav33B/Ed8SxQRNFUmYROC+Y7t0ZhE4L5ju3QeUPvSL/AEvfq5laqZRocYRmAG9AD1u3c4zIOt41H/PmruzVjg/iXtUH/9k=",Q={name:"ImgEdit",data(){return{canvasId:"",canvasApp:null,frame:null,isLoadCanvas:!1,canvasState:[],stateIndex:-1,isDragging:!1,selection:!0,content:"",fileId:"",imgJson:"",imgUrl:"",headId:"",uid:"",selectObj:"",selectColor:"#8282e7",dialogColor:"#ff5e17",direction:1,mosaicImgIndex:0,dialogShape:1,markShape:2,markBorderColor:"red",fontSize:"16",fontFamily:"宋体",fontColor:"red",fontWeight:"light",domain:"http://xxx.com/files/",imgLoading:null,toolbarMents:[{name:"selectTool",label:"选择元素",icon:"el-icon-position"},{name:"alignmentImageTool",label:"重新排版",icon:"iconfont icon-paiban"},{name:"arrowTool",label:"添加箭头",icon:"iconfont icon-jiantou",createdFactory(e,t){return new v.i3({name:"arrowTool",x:e,y:t,toPoint:{x:0,y:0},strokeWidth:2,stroke:"#999999",editable:!0})},onMousemove(e,t,i){console.log(t.selectedGraphics),t.selectedGraphics.toPoint={x:i.width,y:i.height}}},{name:"addTextTool",label:"输入文字",notMove:!0,cursor:"Text",icon:"iconfont icon-tianjiawenzi",createdFactory(e,t){return new g.EYj({name:"textTool",x:e-5,width:200,height:35,y:t-10,text:"请双击编辑内容",fontSize:24,fill:"red",editable:!0})}},{name:"directionTool",label:"添加批注",icon:"iconfont icon-duihuakuang",createdFactory(e,t){return new g.azJ({name:"directionTool",x:e,y:t,width:0,height:0,fill:"#ccc",cornerRadius:20,editable:!0,strokeWidth:2,stroke:2})}},{name:"rectTool",label:"添加矩形",icon:"iconfont icon-zhengfangxing",strokeWidth:2,stroke:"rgba(0, 0, 0, 1)",fill:"#fff",createdFactory(e,t){return new g.rwV({name:"rectTool",x:e,y:t,width:0,height:0,strokeWidth:2,stroke:2,fill:"#999999",editable:!0})}},{name:"ellipseTool",label:"添加圆形",icon:"iconfont icon-yuanxing",strokeWidth:2,stroke:"rgba(0, 0, 0, 1)",fill:"#fff",createdFactory(e,t){return new g.Pp1({name:"ellipseTool",x:e,y:t,width:0,height:0,innerRadius:1,strokeWidth:2,stroke:2,fill:"red",editable:!0})}},{name:"mosaicTool",label:"添加遮挡",icon:"iconfont icon-masaike",strokeWidth:2,stroke:"rgba(0, 0, 0, 1)",fill:"#fff",createdFactory(e,t){return new g.rwV({name:"mosaicTool",className:"mosaic",x:e,y:t,width:0,height:0,fill:{type:"image",url:1==this.mosaicImgIndex?b:E},editable:!0})}},{name:"delSelectElementTool",label:"删除元素",icon:"iconfont icon-shanchu"},{name:"clearAllTool",label:"清空画布",icon:"iconfont icon-qingkong"}],toolbarActiveIndex:0,selectedGraphics:null}},props:{imgData:{type:Object,default:{content:"",fileId:"",imgJson:"",imgUrl:"",headId:"",uid:""}}},watch:{imgData:{handler(e){console.log(e),this.content=e.content,this.fileId=e.fileId,this.imgJson=e.imgJson,this.imgUrl=e.imgUrl,this.headId=e.headId,this.uid=e.uid,this.canvasApp||(this.canvasId="canvas"+Math.floor(1e3*Math.random())+1,this.$nextTick((()=>{this.getStyleAll(),this.init(),this.imgJson&&(console.log(JSON.parse(this.imgJson).children),this.canvasApp.tree.set({children:JSON.parse(this.imgJson).children}),this.frame=this.canvasApp.tree.children[0])})))},immediate:!0,deep:!0},toolbarActiveIndex(e){console.log("newValue"+e),this.setEditorState(!e),this.setCursor()}},methods:{clickHandler(e,t){switch(this.toolbarActiveIndex=e,t){case"selectTool":this.selectionEl();break;case"lockTool":this.lockFn();break;case"upImageTool":this.upImage(),this.toolbarActiveIndex=0;break;case"alignmentImageTool":this.alignmentImage();break;case"delSelectElementTool":this.delSelectElement();break;case"clearAllTool":this.clearAll();break}},lockFn(){console.log(this.frame.children),this.frame.children.forEach((e=>{e.locked=!0}))},setEditorState(e){this.canvasApp.editor.cancel(),this.canvasApp.editor.hittable=e,this.canvasApp.editor.visible=e},setCursor(){const e=this.toolbarMents[this.toolbarActiveIndex].cursor||"crosshair";console.log(e),this.canvasApp.cursor=this.toolbarActiveIndex?e:"auto"},getStyleAll(){},init(){console.log("init"),this.canvasApp=new g.qwe({view:this.canvasId,width:500,height:350,type:"draw",hittable:!0,zoom:{disabled:!0},wheel:{preventDefault:!1},editor:{stroke:this.selectColor,rotateable:!1}}),g.ODD.image.crossOrigin=null,this.canvasApp.on(g._lD.READY,(function(){console.log("加载完成")})),this.canvasApp.on(g.jFN.DOWN,this.mousedown),this.canvasApp.on(g.jFN.DRAG,this.mousemove),this.canvasApp.on(g.jFN.UP,this.mouseup),this.canvasApp.editor.on(g.IvT.SELECT,(e=>{console.log(e),this.selectObj=e.value})),this.frame=new g.wIr({width:500,height:350}),this.canvasApp.tree.add(this.frame)},addDirection(){const e=new g.azJ({x:200,y:200,width:150,height:100,fill:"#FFFFFF",stroke:"#000000",strokeWidth:2,radius:10,editable:!0}),t=new g.tS({sides:3,x:50,y:50,width:20,height:100,strokeWidth:2,stroke:"#999999",editable:!0,zIndex:5,rotate:45});this.frame.add(e),e.add(t)},mousedown(e){this.aop(null,(()=>{const t=this.toolbarMents[this.toolbarActiveIndex];if(!t.createdFactory)return;const{x:i,y:o}=e.getPage();console.log(i,o);const n=t.createdFactory(i,o);this.selectedGraphics=n,this.frame.add(n)}))},mousemove(e){this.aop(null,(()=>{const t=this.toolbarMents[this.toolbarActiveIndex];if(!t.createdFactory)return;if(!this.selectedGraphics)return;if(t.moveable)return;const{x:i,y:o}=this.selectedGraphics;if(console.log(i,o),!i||!o)return;const{x:n,y:a}=e.getPage(),[r,s]=[n-i,a-o];if(console.log(r,s),t.onMousemove)t.onMousemove(e,this,{width:r,height:s});else{const e=r<0?-1:1,t=s<0?-1:1;this.selectedGraphics.scaleX=e,this.selectedGraphics.scaleY=t,this.selectedGraphics.width=Math.abs(r),this.selectedGraphics.height=Math.abs(s)}}))},mouseup(e){this.toolbarActiveIndex=0,this.selectedGraphics=null},aop(e,t){e&&e(),0!==this.toolbarActiveIndex&&t&&t()},selectionEl(){console.log("11"),this.canvasApp.cursor="crosshair"},addText(){console.log(this.fontSize);const e=new g.EYj({fill:this.fontColor,text:"文本",fontSize:this.fontSize,fontFamily:this.fontFamily,fontWeight:this.fontWeight,editable:!0});this.frame.add(e)},addArrow(){const e=new v.i3({y:50,strokeWidth:2,stroke:this.markBorderColor,editable:!0});this.frame.add(e)},alignmentImage(){const e=this.canvasApp.height,t=this.canvasApp.width,i=this.frame.children.filter((e=>e.fill&&"image"===e.fill.type&&"mosaic"!=e.className));let o=0,n=0;if(i.forEach(((t,i)=>{const a=t.width,r=t.height,s=e,l=a/r*s;t.width=l,t.height=s,t.x=o,t.y=0,o+=l,n+=l})),n<t){const e=(t-n)/2;i.forEach((t=>{t.x+=e}))}this.$message({message:"排版成功",type:"success"}),this.toolbarActiveIndex=0},async upImage(){const e=this.frame.children.filter((e=>e.fill&&"image"===e.fill.type&&"mosaic"!=e.className));if(e.length>=3)return this.$message.error("最多上传三张图片");const t=document.getElementById("image-upload");t.click();var i=this;t.onchange=async function(t){console.log(t);var o=t.target.files;if(console.log(o.length),e.length+o.length>3)return t.target.value="",i.$message.error("最多上传三张图片");for(var n=0;n<o.length;n++)o[n]&&(i.imgLoading=i.$loading({lock:!0,text:"第"+(n+1)+"张图片上传中",background:"rgba(0, 0, 0, 0.7)"}),await i.uploadFile(o[n]).then((({data:e})=>{const a=e.data;var r=a.fileUrl;i.addImage(r,n),i.imgLoading.close(),n==o.length-1&&(i.$message({message:"上传成功",type:"success"}),t.target.value="")})))}},addImage(e,t){const i=this.domain+e,o=new Image;o.src=i;var n=this;const a=this.frame.children.filter((e=>e.fill&&"image"===e.fill.type&&"mosaic"!=e.className));var r=30*(t+1);if(a.length>0){var s=[];a.forEach(((e,t)=>{s.push(e.x)})),r=Math.max(...s)+30*(t+1)}console.log("add",r),o.onload=function(){let e=1024,t=768;o.height>o.width&&(e=320,t=768);const a=new g.rwV({width:e,height:t,x:r,y:0,fill:{type:"image",url:i,mode:"stretch"},editable:!0});n.frame.add(a),n.toolbarActiveIndex=0}},addRect(){const e=new g.rwV({width:100,height:100,fill:"transparent",stroke:this.markBorderColor,strokeWidth:2,editable:!0});this.canvasApp.tree.add(e)},addEllipse(){const e=new g.Pp1({width:100,height:100,fill:"transparent",stroke:this.markBorderColor,strokeWidth:2,editable:!0});this.canvasApp.tree.add(e)},addMosaic(){const e=new g.rwV({className:"mosaic",width:100,height:50,fill:{type:"image",url:1==this.mosaicImgIndex?b:E},editable:!0});this.frame.add(e)},delSelectElement(){return Array.isArray(this.selectObj)?(this.selectObj.forEach((e=>{e.destroy(),this.canvasApp.editor.target=null})),"Array"):this.selectObj instanceof Object&&!(this.selectObj instanceof Array)?(this.selectObj.destroy(),this.canvasApp.editor.target=null,"Object"):void 0},clearAll(){this.$confirm("确定要清空当前所有内容吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.canvasApp.tree.clear(),this.canvasApp.editor.target=null,this.frame=new g.wIr({width:1024,height:768}),this.canvasApp.tree.add(this.frame)})).catch((()=>{}))},async savaImg(){var e=this;return console.log({NODE_ENV:"production",BASE_URL:""}.VUE_APP_NODE_ENV),new Promise((async(t,i)=>{const o=await e.canvasApp.tree.export("png",{blob:!0});this.uploadFile(o.data).then((({data:e})=>{const i=e.data;console.log(i),this.imgUrl=i.fileUrl;const o={fileContent:this.content?this.content:"",fileId:i.id,fileJson:this.canvasApp.tree.toString(),uid:this.uid};this.$emit("setData",o),t()}))}))},async uploadFile(e){console.log(e);const t=new FormData;t.append("file",e,"image.png");let i={headers:{"Content-Type":"multipart/form-data"}};return await this.$http.post("/file/upload",t,i)}},mounted(){},beforeDestroy(){this.canvasApp.destroy()}},y=Q,B=(0,l.A)(y,m,p,!1,null,"f2a62eca",null),w=B.exports,x={components:{ImgEdit:w}},k=x,I=(0,l.A)(k,u,f,!1,null,"d7c58cb8",null),O=I.exports;a.Ay.use(h.Ay);const S=[{path:"/",name:"home",component:O},{path:"/about",name:"about",component:()=>i.e(594).then(i.bind(i,1417))}],T=new h.Ay({routes:S});var F=T,N=i(3518);a.Ay.use(N.Ay);var W=new N.Ay.Store({state:{},getters:{},mutations:{},actions:{},modules:{}});a.Ay.config.productionTip=!1,a.Ay.use(n()),new a.Ay({router:F,store:W,render:e=>e(d)}).$mount("#app")}},t={};function i(o){var n=t[o];if(void 0!==n)return n.exports;var a=t[o]={exports:{}};return e[o].call(a.exports,a,a.exports,i),a.exports}i.m=e,function(){var e=[];i.O=function(t,o,n,a){if(!o){var r=1/0;for(A=0;A<e.length;A++){o=e[A][0],n=e[A][1],a=e[A][2];for(var s=!0,l=0;l<o.length;l++)(!1&a||r>=a)&&Object.keys(i.O).every((function(e){return i.O[e](o[l])}))?o.splice(l--,1):(s=!1,a<r&&(r=a));if(s){e.splice(A--,1);var c=n();void 0!==c&&(t=c)}}return t}a=a||0;for(var A=e.length;A>0&&e[A-1][2]>a;A--)e[A]=e[A-1];e[A]=[o,n,a]}}(),function(){i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,{a:t}),t}}(),function(){i.d=function(e,t){for(var o in t)i.o(t,o)&&!i.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){i.f={},i.e=function(e){return Promise.all(Object.keys(i.f).reduce((function(t,o){return i.f[o](e,t),t}),[]))}}(),function(){i.u=function(e){return"js/about.c67607e4.js"}}(),function(){i.miniCssF=function(e){}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="imgedit:";i.l=function(o,n,a,r){if(e[o])e[o].push(n);else{var s,l;if(void 0!==a)for(var c=document.getElementsByTagName("script"),A=0;A<c.length;A++){var d=c[A];if(d.getAttribute("src")==o||d.getAttribute("data-webpack")==t+a){s=d;break}}s||(l=!0,s=document.createElement("script"),s.charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.setAttribute("data-webpack",t+a),s.src=o),e[o]=[n];var h=function(t,i){s.onerror=s.onload=null,clearTimeout(u);var n=e[o];if(delete e[o],s.parentNode&&s.parentNode.removeChild(s),n&&n.forEach((function(e){return e(i)})),t)return t(i)},u=setTimeout(h.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=h.bind(null,s.onerror),s.onload=h.bind(null,s.onload),l&&document.head.appendChild(s)}}}(),function(){i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){i.p=""}(),function(){var e={524:0};i.f.j=function(t,o){var n=i.o(e,t)?e[t]:void 0;if(0!==n)if(n)o.push(n[2]);else{var a=new Promise((function(i,o){n=e[t]=[i,o]}));o.push(n[2]=a);var r=i.p+i.u(t),s=new Error,l=function(o){if(i.o(e,t)&&(n=e[t],0!==n&&(e[t]=void 0),n)){var a=o&&("load"===o.type?"missing":o.type),r=o&&o.target&&o.target.src;s.message="Loading chunk "+t+" failed.\n("+a+": "+r+")",s.name="ChunkLoadError",s.type=a,s.request=r,n[1](s)}};i.l(r,l,"chunk-"+t,t)}},i.O.j=function(t){return 0===e[t]};var t=function(t,o){var n,a,r=o[0],s=o[1],l=o[2],c=0;if(r.some((function(t){return 0!==e[t]}))){for(n in s)i.o(s,n)&&(i.m[n]=s[n]);if(l)var A=l(i)}for(t&&t(o);c<r.length;c++)a=r[c],i.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return i.O(A)},o=self["webpackChunkimgedit"]=self["webpackChunkimgedit"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=i.O(void 0,[504],(function(){return i(3641)}));o=i.O(o)})();
//# sourceMappingURL=app.98426441.js.map